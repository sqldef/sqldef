BooleanValue:
  current: |
    CREATE TABLE bools (
      value1 boolean DEFAULT false,
      value2 boolean DEFAULT False,
      value3 boolean DEFAULT true,
      value4 boolean DEFAULT True,
      value5 TINYINT(1) DEFAULT 0,
      value6 TINYINT(1) DEFAULT 0,
      value7 TINYINT(1) DEFAULT 1,
      value8 TINYINT(1) DEFAULT 1
    );
  desired: |
    CREATE TABLE bools (
      value1 boolean DEFAULT false,
      value2 boolean DEFAULT False,
      value3 boolean DEFAULT true,
      value4 boolean DEFAULT True,
      value5 TINYINT(1) DEFAULT 0,
      value6 TINYINT(1) DEFAULT 0,
      value7 TINYINT(1) DEFAULT 1,
      value8 TINYINT(1) DEFAULT 1
    );
  up: |
  down: |
AddColumnWithDefaultExpression:
  current: |
    CREATE TABLE users (id BIGINT PRIMARY KEY);
  desired: |
    CREATE TABLE users (
      id BIGINT PRIMARY KEY,
      friend_ids JSON DEFAULT(JSON_ARRAY())
    );
  up: |
    ALTER TABLE `users` ADD COLUMN `friend_ids` json DEFAULT(JSON_ARRAY()) AFTER `id`;
  down: |
    ALTER TABLE `users` DROP COLUMN `friend_ids`;
  flavor: mysql  # Different versioning of MariaDB
  min_version: '8.0'
AddDefaultExpression:
  current: |
    CREATE TABLE users (
      id BIGINT PRIMARY KEY,
      friend_ids JSON
    );
  desired: |
    CREATE TABLE users (
      id BIGINT PRIMARY KEY,
      friend_ids JSON DEFAULT(JSON_ARRAY())
    );
  up: |
    ALTER TABLE `users` CHANGE COLUMN `friend_ids` `friend_ids` json DEFAULT(JSON_ARRAY());
  down: |
    ALTER TABLE `users` CHANGE COLUMN `friend_ids` `friend_ids` json;
  flavor: mysql  # Different versioning of MariaDB
  min_version: '8.0'
RemoveDefaultExpression:
  current: |
    CREATE TABLE users (
      id BIGINT PRIMARY KEY,
      friend_ids JSON DEFAULT(JSON_ARRAY())
    );
  desired: |
    CREATE TABLE users (
      id BIGINT PRIMARY KEY,
      friend_ids JSON
    );
  up: |
    ALTER TABLE `users` CHANGE COLUMN `friend_ids` `friend_ids` json;
  down: |
    ALTER TABLE `users` CHANGE COLUMN `friend_ids` `friend_ids` json DEFAULT(JSON_ARRAY());
  flavor: mysql  # Different versioning of MariaDB
  min_version: '8.0'
JsonColumnWithCharsetCastDefault:
  desired: |
    CREATE TABLE hello_json_utf8mb4 (
      id int NOT NULL AUTO_INCREMENT,
      json_col json NOT NULL DEFAULT (_utf8mb4'{}'),
      PRIMARY KEY (id)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;
  flavor: mysql  # Different versioning of MariaDB
  min_version: '8.0.13'
CollateOnColumn:
  desired: |
    create table users
    (
        id   int          not null,
        name varchar(255) not null
    ) COLLATE=utf8mb4_general_ci;
    create view user_view as
    select u.id as id,
           (u.name collate `utf8mb4_unicode_ci`) as name
    from mysqldef_test.users as u;
  flavor: mysql  # MariaDB shows unexpected view changes in idempotency tests
AutoIncrementNotNull:
  desired: |
    CREATE TABLE users1 (
      id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY
    );
    CREATE TABLE users2 (
      id BIGINT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY
    );
TypeAliases:
  desired: |
    CREATE TABLE users (
      charv character(40),
      varcharv character varying(40),
      intv integer
    );
Boolean:
  desired: |
    CREATE TABLE users (
      bool_flag BOOL,
      boolean_flag BOOLEAN
    );
DefaultNull:
  current: |
    CREATE TABLE users (
      id bigint(20) NOT NULL
    );
  desired: |
    CREATE TABLE users (
      id bigint(20) NOT NULL,
      name varchar(40) DEFAULT NULL
    );
  up: |
    ALTER TABLE `users` ADD COLUMN `name` varchar(40) DEFAULT null AFTER `id`;
  down: |
    ALTER TABLE `users` DROP COLUMN `name`;
AddNotNull:
  current: |
    CREATE TABLE users (
      name varchar(255) DEFAULT NULL
    );
  desired: |
    CREATE TABLE users (
      name varchar(255) NOT NULL
    );
  up: |
    ALTER TABLE `users` CHANGE COLUMN `name` `name` varchar(255) NOT NULL;
  down: |
    ALTER TABLE `users` CHANGE COLUMN `name` `name` varchar(255) DEFAULT null;
CreateTableAddColumnWithCharsetAndNotNull:
  current: |
    CREATE TABLE users (
      id bigint NOT NULL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE users (
      id bigint NOT NULL,
      name VARCHAR(20) CHARACTER SET ascii COLLATE ascii_bin NOT NULL,
      PRIMARY KEY (id)
    );
  up: |
    ALTER TABLE `users` ADD COLUMN `name` varchar(20) CHARACTER SET ascii COLLATE ascii_bin NOT NULL AFTER `id`;
  down: |
    ALTER TABLE `users` DROP COLUMN `name`;
OnUpdate:
  current: |
    CREATE TABLE users (
      name varchar(40),
      updated_at datetime DEFAULT current_timestamp ON UPDATE current_timestamp,
      created_at datetime NOT NULL
    );
  desired: |
    CREATE TABLE users (
      name varchar(40),
      updated_at datetime DEFAULT current_timestamp,
      created_at datetime NOT NULL
    );
  up: |
    ALTER TABLE `users` CHANGE COLUMN `updated_at` `updated_at` datetime DEFAULT current_timestamp;
  down: |
    ALTER TABLE `users` CHANGE COLUMN `updated_at` `updated_at` datetime DEFAULT current_timestamp ON UPDATE current_timestamp;
OnUpdateAdd:
  current: |
    CREATE TABLE users (
      name varchar(40),
      updated_at datetime DEFAULT current_timestamp,
      created_at datetime NOT NULL
    );
  desired: |
    CREATE TABLE users (
      name varchar(40),
      updated_at datetime DEFAULT current_timestamp ON UPDATE current_timestamp,
      created_at datetime NOT NULL
    );
  up: |
    ALTER TABLE `users` CHANGE COLUMN `updated_at` `updated_at` datetime DEFAULT current_timestamp ON UPDATE current_timestamp;
  down: |
    ALTER TABLE `users` CHANGE COLUMN `updated_at` `updated_at` datetime DEFAULT current_timestamp;
OnUpdateParentheses:
  current: |
    CREATE TABLE users (
      name varchar(40),
      updated_at datetime DEFAULT current_timestamp ON UPDATE current_timestamp,
      created_at datetime NOT NULL
    );
  desired: |
    CREATE TABLE users (
      name varchar(40),
      updated_at datetime DEFAULT current_timestamp() ON UPDATE current_timestamp(),
      created_at datetime NOT NULL
    );
  up: ""
  down: ""
CurrentTimestampWithPrecision:
  current: |
    CREATE TABLE users (
      created_at datetime(6) DEFAULT current_timestamp(6)
    );
  desired: |
    CREATE TABLE users (
      created_at datetime(6) DEFAULT current_timestamp(6),
      updated_at datetime(6) DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6)
    );
  up: |
    ALTER TABLE `users` ADD COLUMN `updated_at` datetime(6) DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6) AFTER `created_at`;
  down: |
    ALTER TABLE `users` DROP COLUMN `updated_at`;
EnumValues:
  current: |
    CREATE TABLE users (
      id bigint(20) NOT NULL
    );
  desired: |
    CREATE TABLE users (
      id bigint(20) NOT NULL,
      authorities enum('normal', 'admin') NOT NULL DEFAULT 'normal'
    );
  up: |
    ALTER TABLE `users` ADD COLUMN `authorities` enum('normal', 'admin') NOT NULL DEFAULT 'normal' AFTER `id`;
  down: |
    ALTER TABLE `users` DROP COLUMN `authorities`;
DefaultValue:
  current: |
    CREATE TABLE tools (
      id int(10) unsigned NOT NULL AUTO_INCREMENT,
      name varchar(255) COLLATE utf8mb4_bin NOT NULL,
      created_at datetime NOT NULL,
      updated_at datetime NOT NULL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE tools (
      id int(10) unsigned NOT NULL AUTO_INCREMENT,
      name varchar(255) COLLATE utf8mb4_bin NOT NULL,
      created_at datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
      updated_at datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
      PRIMARY KEY (id)
    );
  up: |
    ALTER TABLE `tools` CHANGE COLUMN `created_at` `created_at` datetime NOT NULL DEFAULT current_timestamp;
    ALTER TABLE `tools` CHANGE COLUMN `updated_at` `updated_at` datetime NOT NULL DEFAULT current_timestamp ON UPDATE current_timestamp;
  down: |
    ALTER TABLE `tools` CHANGE COLUMN `created_at` `created_at` datetime NOT NULL;
    ALTER TABLE `tools` CHANGE COLUMN `updated_at` `updated_at` datetime NOT NULL;
NegativeDefault:
  current: |
    CREATE TABLE items (
      position float DEFAULT -20
    );
  desired: |
    CREATE TABLE items (
      position float DEFAULT 100
    );
  up: |
    ALTER TABLE `items` CHANGE COLUMN `position` `position` float DEFAULT 100;
  down: |
    ALTER TABLE `items` CHANGE COLUMN `position` `position` float DEFAULT -20;
DecimalDefault:
  current: |
    CREATE TABLE some_table (
      v0 decimal(5, 2) DEFAULT 0.0,
      v1 decimal(5, 2) DEFAULT 1.2,
      v2 decimal(35, 30) DEFAULT  0.12345,
      v3 decimal(35, 30) DEFAULT '1.0000000000123456789123'
    );
  desired: |
    CREATE TABLE some_table (
      v0 decimal(5, 2) DEFAULT 0.01,
      v1 decimal(5, 2) DEFAULT 1.23,
      v2 decimal(35, 30) DEFAULT  0.1234,
      v3 decimal(35, 30) DEFAULT '1.00000000001234567891234'
    );
  up: |
    ALTER TABLE `some_table` CHANGE COLUMN `v0` `v0` decimal(5, 2) DEFAULT 0.010000;
    ALTER TABLE `some_table` CHANGE COLUMN `v1` `v1` decimal(5, 2) DEFAULT 1.230000;
    ALTER TABLE `some_table` CHANGE COLUMN `v2` `v2` decimal(35, 30) DEFAULT 0.123400;
    ALTER TABLE `some_table` CHANGE COLUMN `v3` `v3` decimal(35, 30) DEFAULT '1.00000000001234567891234';
  down: |
    ALTER TABLE `some_table` CHANGE COLUMN `v0` `v0` decimal(5, 2) DEFAULT 0.000000;
    ALTER TABLE `some_table` CHANGE COLUMN `v1` `v1` decimal(5, 2) DEFAULT 1.200000;
    ALTER TABLE `some_table` CHANGE COLUMN `v2` `v2` decimal(35, 30) DEFAULT 0.123450;
    ALTER TABLE `some_table` CHANGE COLUMN `v3` `v3` decimal(35, 30) DEFAULT '1.0000000000123456789123';
NegativeDefaultNumbers:
  desired: |
    CREATE TABLE items (
      v0 float DEFAULT - 20,
      v1 float DEFAULT -3.14,
      v6 float DEFAULT -20,
      v7 decimal(5, 2) DEFAULT -20.0,
      v8 decimal(5, 2) DEFAULT 20.0,
      v9 decimal(5, 2) DEFAULT 0.0,
      v10 decimal(10, 4) DEFAULT 0.001,
      v11 decimal(10, 4) DEFAULT -0.001
    );
DefaultString:
  current: |
    CREATE TABLE some_table (
      v0 VARCHAR(255) DEFAULT 'foo',
      v1 VARCHAR(255) DEFAULT 'BAR',
      v2 VARCHAR(255) DEFAULT '1.00',
      v3 VARCHAR(255) DEFAULT '1.00'
    );
  desired: |
    CREATE TABLE some_table (
      v0 VARCHAR(255) DEFAULT 'FOO',
      v1 VARCHAR(255) DEFAULT 'bar',
      v2 VARCHAR(255) DEFAULT '1.0000',
      v3 VARCHAR(255) DEFAULT '1'
    );
  up: |
    ALTER TABLE `some_table` CHANGE COLUMN `v0` `v0` varchar(255) DEFAULT 'FOO';
    ALTER TABLE `some_table` CHANGE COLUMN `v1` `v1` varchar(255) DEFAULT 'bar';
    ALTER TABLE `some_table` CHANGE COLUMN `v2` `v2` varchar(255) DEFAULT '1.0000';
    ALTER TABLE `some_table` CHANGE COLUMN `v3` `v3` varchar(255) DEFAULT '1';
  down: |
    ALTER TABLE `some_table` CHANGE COLUMN `v0` `v0` varchar(255) DEFAULT 'foo';
    ALTER TABLE `some_table` CHANGE COLUMN `v1` `v1` varchar(255) DEFAULT 'BAR';
    ALTER TABLE `some_table` CHANGE COLUMN `v2` `v2` varchar(255) DEFAULT '1.00';
    ALTER TABLE `some_table` CHANGE COLUMN `v3` `v3` varchar(255) DEFAULT '1.00';
NumericDecimalDefaults:
  current: |
    CREATE TABLE test (
      id int,
      num numeric,
      price decimal
    );
  desired: |
    CREATE TABLE test (
      id int,
      num numeric(10),
      price decimal(10)
    );
  up: ""
  down: ""
NumericDecimalExplicit:
  current: |
    CREATE TABLE test (
      id int,
      num1 numeric(15),
      num2 numeric(15, 4),
      price1 decimal(12),
      price2 decimal(20, 6)
    );
  desired: |
    CREATE TABLE test (
      id int,
      num1 numeric(15),
      num2 numeric(15, 4),
      price1 decimal(12),
      price2 decimal(20, 6)
    );
  up: ""
  down: ""
TypedLiterals:
  flavor: mysql
  min_version: '8.0'
  current: |
    CREATE TABLE events (
      id int NOT NULL AUTO_INCREMENT,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE events (
      id int NOT NULL AUTO_INCREMENT,
      event_date date DEFAULT DATE '2024-01-01',
      event_time time DEFAULT TIME '12:00:00',
      event_timestamp timestamp DEFAULT TIMESTAMP '2024-01-01 12:00:00',
      PRIMARY KEY (id)
    );
  up: |
    ALTER TABLE `events` ADD COLUMN `event_date` date DEFAULT(date '2024-01-01') AFTER `id`;
    ALTER TABLE `events` ADD COLUMN `event_time` time DEFAULT(time '12:00:00') AFTER `event_date`;
    ALTER TABLE `events` ADD COLUMN `event_timestamp` timestamp DEFAULT(timestamp '2024-01-01 12:00:00') AFTER `event_time`;
  down: |
    ALTER TABLE `events` DROP COLUMN `event_timestamp`;
    ALTER TABLE `events` DROP COLUMN `event_time`;
    ALTER TABLE `events` DROP COLUMN `event_date`;
TypedLiteralsIdempotency:
  flavor: mysql
  min_version: '8.0'
  current: |
    CREATE TABLE events (
      id int NOT NULL AUTO_INCREMENT,
      event_date date DEFAULT '2024-01-01',
      event_time time DEFAULT '12:00:00',
      event_timestamp timestamp DEFAULT '2024-01-01 12:00:00',
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE events (
      id int NOT NULL AUTO_INCREMENT,
      event_date date DEFAULT DATE '2024-01-01',
      event_time time DEFAULT TIME '12:00:00',
      event_timestamp timestamp DEFAULT TIMESTAMP '2024-01-01 12:00:00',
      PRIMARY KEY (id)
    );
  up: |
    ALTER TABLE `events` CHANGE COLUMN `event_date` `event_date` date DEFAULT(date '2024-01-01');
    ALTER TABLE `events` CHANGE COLUMN `event_time` `event_time` time DEFAULT(time '12:00:00');
    ALTER TABLE `events` CHANGE COLUMN `event_timestamp` `event_timestamp` timestamp DEFAULT(timestamp '2024-01-01 12:00:00');
  down: |
    ALTER TABLE `events` CHANGE COLUMN `event_date` `event_date` date DEFAULT '2024-01-01';
    ALTER TABLE `events` CHANGE COLUMN `event_time` `event_time` time DEFAULT '12:00:00';
    ALTER TABLE `events` CHANGE COLUMN `event_timestamp` `event_timestamp` timestamp DEFAULT '2024-01-01 12:00:00';
TypedLiteralsChangeDefault:
  flavor: mysql
  min_version: '8.0'
  current: |
    CREATE TABLE events (
      id int NOT NULL AUTO_INCREMENT,
      event_date date DEFAULT '2024-01-01',
      event_time time DEFAULT '12:00:00',
      event_timestamp timestamp DEFAULT '2024-01-01 12:00:00',
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE events (
      id int NOT NULL AUTO_INCREMENT,
      event_date date DEFAULT DATE '2024-12-31',
      event_time time DEFAULT TIME '23:59:59',
      event_timestamp timestamp DEFAULT TIMESTAMP '2024-12-31 23:59:59',
      PRIMARY KEY (id)
    );
  up: |
    ALTER TABLE `events` CHANGE COLUMN `event_date` `event_date` date DEFAULT(date '2024-12-31');
    ALTER TABLE `events` CHANGE COLUMN `event_time` `event_time` time DEFAULT(time '23:59:59');
    ALTER TABLE `events` CHANGE COLUMN `event_timestamp` `event_timestamp` timestamp DEFAULT(timestamp '2024-12-31 23:59:59');
  down: |
    ALTER TABLE `events` CHANGE COLUMN `event_date` `event_date` date DEFAULT '2024-01-01';
    ALTER TABLE `events` CHANGE COLUMN `event_time` `event_time` time DEFAULT '12:00:00';
    ALTER TABLE `events` CHANGE COLUMN `event_timestamp` `event_timestamp` timestamp DEFAULT '2024-01-01 12:00:00';
TypedLiteralsInCheck:
  flavor: mysql
  min_version: '8.0'
  current: |
    CREATE TABLE events (
      id int NOT NULL AUTO_INCREMENT,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE events (
      id int NOT NULL AUTO_INCREMENT,
      event_date date,
      event_end_date date,
      PRIMARY KEY (id),
      CONSTRAINT chk_date_range CHECK (event_date >= DATE '2020-01-01' AND event_end_date <= DATE '2030-12-31')
    );
  up: |
    ALTER TABLE `events` ADD COLUMN `event_date` date AFTER `id`;
    ALTER TABLE `events` ADD COLUMN `event_end_date` date AFTER `event_date`;
    ALTER TABLE `events` ADD CONSTRAINT `chk_date_range` CHECK (event_date >= date '2020-01-01' and event_end_date <= date '2030-12-31');

  down: |
    ALTER TABLE `events` DROP CHECK `chk_date_range`;
    ALTER TABLE `events` DROP COLUMN `event_end_date`;
    ALTER TABLE `events` DROP COLUMN `event_date`;