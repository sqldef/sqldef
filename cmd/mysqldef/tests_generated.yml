CreateTableGeneratedAlwaysAs80:
  desired: |
    CREATE TABLE `test_table` (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) VIRTUAL,
      PRIMARY KEY (id)
    );
  min_version: '8.0'
CreateTableGeneratedAlwaysAsChangeExpr80:
  current: |
    CREATE TABLE `test_table` (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) VIRTUAL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE `test_table` (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) VIRTUAL,
      PRIMARY KEY (id)
    );
  output: |
    ALTER TABLE `test_table` DROP COLUMN `test_expr`;
    ALTER TABLE `test_table` ADD COLUMN `test_expr` varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) VIRTUAL AFTER `test_value`;
  flavor: mysql  # Different versioning of MariaDB
  min_version: '8.0'
CreateTableGeneratedAlwaysAsAbbreviation80:
  desired: |
    CREATE TABLE `test_table` (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) AS ('test') STORED NOT NULL,
      test_expr varchar(45) AS (test_value / test_value) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  flavor: mysql  # Different versioning of MariaDB
  min_version: '8.0'
CreateTableGeneratedAlwaysAsAbbreviationChangeExpr80:
  current: |
    CREATE TABLE `test_table` (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') STORED NOT NULL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE `test_table` (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) AS ('test') STORED NOT NULL,
      test_expr varchar(45) AS ((test_value / test_value) * 2) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  output: |
    ALTER TABLE `test_table` DROP COLUMN `test_expr`;
    ALTER TABLE `test_table` ADD COLUMN `test_expr` varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) STORED NOT NULL AFTER `test_value`;
  flavor: mysql  # Different versioning of MariaDB
  min_version: '8.0'
ChangeGenerateColumnGemerayedAlwaysAs:
  desired: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) VIRTUAL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name1')) VIRTUAL,
      PRIMARY KEY (id)
    );
  flavor: mysql  # MariaDB shows unexpected JSON column changes in idempotency tests
ChangeGenerateColumnJsonExpressionChange:
  current: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) VIRTUAL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name1')) VIRTUAL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) VIRTUAL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name2')) VIRTUAL,
      PRIMARY KEY (id)
    );
  output: |
    ALTER TABLE `test_table` DROP COLUMN `name`;
    ALTER TABLE `test_table` ADD COLUMN `name` varchar(20) GENERATED ALWAYS AS (json_extract(data, '$.name2')) VIRTUAL AFTER `data`;
  flavor: mysql  # MariaDB handles generated column comparison differently, shows extra JSON column changes
ChangeGenerateColumnVirtualToStored:
  current: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) VIRTUAL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name2')) VIRTUAL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) STORED,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name2')) STORED,
      PRIMARY KEY (id)
    );
  output: |
    ALTER TABLE `test_table` DROP COLUMN `test_expr`;
    ALTER TABLE `test_table` ADD COLUMN `test_expr` varchar(45) GENERATED ALWAYS AS (test_value / test_value) STORED AFTER `test_value`;
    ALTER TABLE `test_table` DROP COLUMN `name`;
    ALTER TABLE `test_table` ADD COLUMN `name` varchar(20) GENERATED ALWAYS AS (json_extract(data, '$.name2')) STORED AFTER `data`;
  flavor: mysql  # MariaDB shows unexpected JSON column changes in idempotency tests
ChangeGenerateColumnSpacingIgnored:
  current: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) STORED,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name2')) STORED,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS ( test_value / test_value ) STORED,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data, '$.name2')) STORED,
      PRIMARY KEY (id)
    );
  output: ""
  flavor: mysql  # MariaDB shows unexpected JSON column changes in idempotency tests
ChangeGenerateColumnAddNotNull:
  current: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS ( test_value / test_value ) STORED,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data, '$.name2')) STORED,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) STORED NOT NULL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name2')) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  output: |
    ALTER TABLE `test_table` DROP COLUMN `test_expr`;
    ALTER TABLE `test_table` ADD COLUMN `test_expr` varchar(45) GENERATED ALWAYS AS (test_value / test_value) STORED NOT NULL AFTER `test_value`;
    ALTER TABLE `test_table` DROP COLUMN `name`;
    ALTER TABLE `test_table` ADD COLUMN `name` varchar(20) GENERATED ALWAYS AS (json_extract(data, '$.name2')) STORED NOT NULL AFTER `data`;
  flavor: mysql  # MariaDB syntax error with STORED NOT NULL on generated columns
ChangeGenerateColumnExpressionComplexity:
  current: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS (test_value / test_value) STORED NOT NULL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name2')) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) STORED NOT NULL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name2')) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  output: |
    ALTER TABLE `test_table` DROP COLUMN `test_expr`;
    ALTER TABLE `test_table` ADD COLUMN `test_expr` varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) STORED NOT NULL AFTER `test_value`;
  flavor: mysql  # MariaDB syntax error with generated columns and NOT NULL
ChangeGenerateColumnSubstrFunction:
  current: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) STORED NOT NULL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (json_extract(data,'$.name2')) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) STORED NOT NULL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (substr('test_value', 1, 2)) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  output: |
    ALTER TABLE `test_table` DROP COLUMN `name`;
    ALTER TABLE `test_table` ADD COLUMN `name` varchar(20) GENERATED ALWAYS AS (substr('test_value', 1, 2)) STORED NOT NULL AFTER `data`;
  flavor: mysql  # MariaDB syntax error with generated columns and NOT NULL constraint
ChangeGenerateColumnSubstringFunction:
  current: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) STORED NOT NULL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (substr('test_value', 1, 2)) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  desired: |
    CREATE TABLE test_table (
      id int(11) NOT NULL AUTO_INCREMENT,
      test_value varchar(45) GENERATED ALWAYS AS ('test') VIRTUAL,
      test_expr varchar(45) GENERATED ALWAYS AS ((test_value / test_value) * 2) STORED NOT NULL,
      data json NOT NULL,
      name varchar(20) GENERATED ALWAYS AS (substring('test_value', 2, 2)) STORED NOT NULL,
      PRIMARY KEY (id)
    );
  output: |
    ALTER TABLE `test_table` DROP COLUMN `name`;
    ALTER TABLE `test_table` ADD COLUMN `name` varchar(20) GENERATED ALWAYS AS (substr('test_value', 2, 2)) STORED NOT NULL AFTER `data`;
  flavor: mysql  # MariaDB syntax error with generated columns and NOT NULL
