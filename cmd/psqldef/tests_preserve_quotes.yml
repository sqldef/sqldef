TableQuotedPreservesCase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int);
  desired: |
    CREATE TABLE "Users" (id int, name text);
  up: |
    ALTER TABLE public."Users" ADD COLUMN name text;

  down: |
    ALTER TABLE public."Users" DROP COLUMN name;
TableUnquotedNormalizesToLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE Users (id int);
  desired: |
    CREATE TABLE Users (id int, name text);
  up: |
    ALTER TABLE public.users ADD COLUMN name text;

  down: |
    ALTER TABLE public.users DROP COLUMN name;
TableQuotedVsUnquotedAreDifferent:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int);
    CREATE TABLE users (id int);
  desired: |
    CREATE TABLE "Users" (id int, name text);
    CREATE TABLE users (id int, email text);
  up: |
    ALTER TABLE public."Users" ADD COLUMN name text;
    ALTER TABLE public.users ADD COLUMN email text;

  down: |
    ALTER TABLE public."Users" DROP COLUMN name;
    ALTER TABLE public.users DROP COLUMN email;
ColumnQuotedPreservesCase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users ("Name" text);
  desired: |
    CREATE TABLE users ("Name" text NOT NULL);
  up: |
    ALTER TABLE public.users ALTER COLUMN "Name" SET NOT NULL;

  down: |
    ALTER TABLE public.users ALTER COLUMN "Name" DROP NOT NULL;
ColumnUnquotedNormalizesToLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (Name text);
  desired: |
    CREATE TABLE users (Name text NOT NULL);
  up: |
    ALTER TABLE public.users ALTER COLUMN name SET NOT NULL;

  down: |
    ALTER TABLE public.users ALTER COLUMN name DROP NOT NULL;
ColumnQuotedVsUnquotedAreDifferent:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users ("Name" text, name text);
  desired: |
    CREATE TABLE users ("Name" text NOT NULL, name text NOT NULL);
  up: |
    ALTER TABLE public.users ALTER COLUMN "Name" SET NOT NULL;
    ALTER TABLE public.users ALTER COLUMN name SET NOT NULL;

  down: |
    ALTER TABLE public.users ALTER COLUMN "Name" DROP NOT NULL;
    ALTER TABLE public.users ALTER COLUMN name DROP NOT NULL;
TableUnquotedEqualsQuotedLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int);
  desired: |
    CREATE TABLE "users" (id int);
  up: ""
  down: ""

ColumnUnquotedEqualsQuotedLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (name text);
  desired: |
    CREATE TABLE users ("name" text);
  up: ""
  down: ""

ConstraintUnquotedEqualsQuotedLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      email text,
      CONSTRAINT email_unique UNIQUE (email)
    );
  desired: |
    CREATE TABLE users (
      id int,
      email text,
      CONSTRAINT "email_unique" UNIQUE (email)
    );
  up: ""
  down: ""

IndexUnquotedEqualsQuotedLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, email text);
    CREATE INDEX email_idx ON users (email);
  desired: |
    CREATE TABLE users (id int, email text);
    CREATE INDEX "email_idx" ON users (email);
  up: ""
  down: ""

ViewQuotedPreservesCase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int);
    CREATE VIEW "ActiveUsers" AS SELECT id FROM users;
  desired: |
    CREATE TABLE users (id int, name text);
    CREATE VIEW "ActiveUsers" AS SELECT id FROM users;
  up: |
    ALTER TABLE public.users ADD COLUMN name text;

  down: |
    ALTER TABLE public.users DROP COLUMN name;
ViewUnquotedNormalizesToLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int);
    CREATE VIEW ActiveUsers AS SELECT id FROM users;
  desired: |
    CREATE TABLE users (id int, name text);
    CREATE VIEW ActiveUsers AS SELECT id FROM users;
  up: |
    ALTER TABLE public.users ADD COLUMN name text;

  down: |
    ALTER TABLE public.users DROP COLUMN name;
TypeQuotedPreservesCase:
  legacy_ignore_quotes: false
  current: |
    CREATE TYPE "UserStatus" AS ENUM ('active', 'inactive');
    CREATE TABLE users (id int, status "UserStatus");
  desired: |
    CREATE TYPE "UserStatus" AS ENUM ('active', 'inactive');
    CREATE TABLE users (id int, status "UserStatus", name text);
  up: |
    ALTER TABLE public.users ADD COLUMN name text;

  down: |
    ALTER TABLE public.users DROP COLUMN name;
TypeUnquotedNormalizesToLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TYPE UserStatus AS ENUM ('active', 'inactive');
    CREATE TABLE users (id int, status userstatus);
  desired: |
    CREATE TYPE UserStatus AS ENUM ('active', 'inactive');
    CREATE TABLE users (id int, status userstatus, name text);
  up: |
    ALTER TABLE public.users ADD COLUMN name text;

  down: |
    ALTER TABLE public.users DROP COLUMN name;
DomainQuotedPreservesCase:
  legacy_ignore_quotes: false
  current: |
    CREATE DOMAIN "PositiveInt" AS int CHECK (VALUE > 0);
    CREATE TABLE users (id "PositiveInt");
  desired: |
    CREATE DOMAIN "PositiveInt" AS int CHECK (VALUE > 0);
    CREATE TABLE users (id "PositiveInt", score "PositiveInt");
  up: |
    ALTER TABLE public.users ADD COLUMN score "PositiveInt";

  down: |
    ALTER TABLE public.users DROP COLUMN score;
DomainUnquotedNormalizesToLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE DOMAIN PositiveInt AS int CHECK (VALUE > 0);
    CREATE TABLE users (id positiveint);
  desired: |
    CREATE DOMAIN PositiveInt AS int CHECK (VALUE > 0);
    CREATE TABLE users (id positiveint, score positiveint);
  up: |
    ALTER TABLE public.users ADD COLUMN score positiveint;

  down: |
    ALTER TABLE public.users DROP COLUMN score;
IndexQuotedPreservesCase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, email text);
    CREATE INDEX "EmailIndex" ON users (email);
  desired: |
    CREATE TABLE users (id int, email text, name text);
    CREATE INDEX "EmailIndex" ON users (email);
  up: |
    ALTER TABLE public.users ADD COLUMN name text;

  down: |
    ALTER TABLE public.users DROP COLUMN name;
IndexUnquotedNormalizesToLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, email text);
    CREATE INDEX EmailIndex ON users (email);
  desired: |
    CREATE TABLE users (id int, email text, name text);
    CREATE INDEX EmailIndex ON users (email);
  up: |
    ALTER TABLE public.users ADD COLUMN name text;

  down: |
    ALTER TABLE public.users DROP COLUMN name;
CreateIndexOnQuotedTable:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int);
  desired: |
    CREATE TABLE "Users" (id int);
    CREATE INDEX email_idx ON "Users" (id);
  up: |
    CREATE INDEX email_idx ON public."Users" (id);

  down: |
    DROP INDEX public.email_idx;
CreateIndexOnUnquotedTable:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE Users (id int);
  desired: |
    CREATE TABLE Users (id int);
    CREATE INDEX email_idx ON Users (id);
  up: |
    CREATE INDEX email_idx ON public.users (id);

  down: |
    DROP INDEX public.email_idx;
AddIndexToQuotedTable:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int, email text);
  desired: |
    CREATE TABLE "Users" (id int, email text);
    CREATE INDEX email_idx ON "Users" (email);
  up: |
    CREATE INDEX email_idx ON public."Users" (email);

  down: |
    DROP INDEX public.email_idx;
AddIndexToUnquotedTable:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE Users (id int, email text);
  desired: |
    CREATE TABLE Users (id int, email text);
    CREATE INDEX email_idx ON Users (email);
  up: |
    CREATE INDEX email_idx ON public.users (email);

  down: |
    DROP INDEX public.email_idx;
ConstraintQuotedPreservesCase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int CONSTRAINT "PrimaryKey" PRIMARY KEY);
  desired: |
    CREATE TABLE users (id int CONSTRAINT "PrimaryKey" PRIMARY KEY, email text UNIQUE);
  up: |
    ALTER TABLE public.users ADD COLUMN email text UNIQUE;

  down: |
    ALTER TABLE public.users DROP CONSTRAINT "users_email_key";
    ALTER TABLE public.users DROP COLUMN email;
ConstraintUnquotedNormalizesToLowercase:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int CONSTRAINT PrimaryKey PRIMARY KEY);
  desired: |
    CREATE TABLE users (id int CONSTRAINT PrimaryKey PRIMARY KEY, email text UNIQUE);
  up: |
    ALTER TABLE public.users ADD COLUMN email text UNIQUE;

  down: |
    ALTER TABLE public.users DROP CONSTRAINT "users_email_key";
    ALTER TABLE public.users DROP COLUMN email;
MixedQuotedAndUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int);
    CREATE TABLE users (id int);
  desired: |
    CREATE TABLE "Users" ("Name" text);
    CREATE TABLE users (name text);
  up: |
    ALTER TABLE public."Users" ADD COLUMN "Name" text;
    ALTER TABLE public.users ADD COLUMN name text;
    ALTER TABLE public."Users" DROP COLUMN id;
    ALTER TABLE public.users DROP COLUMN id;

  down: |
    ALTER TABLE public."Users" ADD COLUMN id integer;
    ALTER TABLE public.users ADD COLUMN id integer;
    ALTER TABLE public."Users" DROP COLUMN "Name";
    ALTER TABLE public.users DROP COLUMN name;
ComplexMixedCaseScenario:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "UserProfiles" (
      "UserId" int,
      user_name text
    );
  desired: |
    CREATE TABLE "UserProfiles" (
      "UserId" int PRIMARY KEY,
      user_name text NOT NULL,
      "CreatedAt" timestamp DEFAULT CURRENT_TIMESTAMP
    );
  up: |
    ALTER TABLE public."UserProfiles" ALTER COLUMN user_name SET NOT NULL;
    ALTER TABLE public."UserProfiles" ADD COLUMN "CreatedAt" timestamp DEFAULT current_timestamp;
    ALTER TABLE public."UserProfiles" ADD PRIMARY KEY ("UserId");

  down: |
    ALTER TABLE public."UserProfiles" ALTER COLUMN user_name DROP NOT NULL;
    ALTER TABLE public."UserProfiles" DROP CONSTRAINT "UserProfiles_pkey";
    ALTER TABLE public."UserProfiles" DROP COLUMN "CreatedAt";
ForeignKeyToQuotedTable:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (
      "UserId" int PRIMARY KEY
    );
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int
    );
  desired: |
    CREATE TABLE "Users" (
      "UserId" int PRIMARY KEY
    );
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES "Users" ("UserId")
    );
  up: |
    ALTER TABLE public.orders ADD CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES public."Users" ("UserId");

  down: |
    ALTER TABLE public.orders DROP CONSTRAINT "fk_user";
ForeignKeyWithQuotedConstraintName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (id int PRIMARY KEY, user_id int);
  desired: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT "FK_Orders_Users" FOREIGN KEY (user_id) REFERENCES users (id)
    );
  up: |
    ALTER TABLE public.orders ADD CONSTRAINT "FK_Orders_Users" FOREIGN KEY (user_id) REFERENCES public.users (id);

  down: |
    ALTER TABLE public.orders DROP CONSTRAINT "FK_Orders_Users";
ForeignKeyBetweenQuotedAndUnquotedTables:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" ("UserId" int PRIMARY KEY);
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE "Orders" (id int PRIMARY KEY, quoted_user_id int, unquoted_user_id int);
  desired: |
    CREATE TABLE "Users" ("UserId" int PRIMARY KEY);
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE "Orders" (
      id int PRIMARY KEY,
      quoted_user_id int,
      unquoted_user_id int,
      CONSTRAINT "fk_quoted" FOREIGN KEY (quoted_user_id) REFERENCES "Users" ("UserId"),
      CONSTRAINT fk_unquoted FOREIGN KEY (unquoted_user_id) REFERENCES users (id)
    );
  up: |
    ALTER TABLE public."Orders" ADD CONSTRAINT "fk_quoted" FOREIGN KEY (quoted_user_id) REFERENCES public."Users" ("UserId");
    ALTER TABLE public."Orders" ADD CONSTRAINT fk_unquoted FOREIGN KEY (unquoted_user_id) REFERENCES public.users (id);

  down: |
    ALTER TABLE public."Orders" DROP CONSTRAINT "fk_quoted";
    ALTER TABLE public."Orders" DROP CONSTRAINT "fk_unquoted";
ArrayTypeWithQuotedCustomType:
  legacy_ignore_quotes: false
  current: |
    CREATE TYPE "UserRole" AS ENUM ('admin', 'user');
    CREATE TABLE users (id int);
  desired: |
    CREATE TYPE "UserRole" AS ENUM ('admin', 'user');
    CREATE TABLE users (id int, roles "UserRole"[]);
  up: |
    ALTER TABLE public.users ADD COLUMN roles "UserRole"[];

  down: |
    ALTER TABLE public.users DROP COLUMN roles;
ArrayTypeWithUnquotedCustomType:
  legacy_ignore_quotes: false
  current: |
    CREATE TYPE userrole AS ENUM ('admin', 'user');
    CREATE TABLE users (id int);
  desired: |
    CREATE TYPE userrole AS ENUM ('admin', 'user');
    CREATE TABLE users (id int, roles userrole[]);
  up: |
    ALTER TABLE public.users ADD COLUMN roles userrole[];

  down: |
    ALTER TABLE public.users DROP COLUMN roles;
CheckConstraintQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE products (id int, price int);
  desired: |
    CREATE TABLE products (
      id int,
      price int CONSTRAINT "Price_Positive" CHECK (price > 0)
    );
  up: |
    ALTER TABLE public.products ADD CONSTRAINT "Price_Positive" CHECK (price > 0);

  down: |
    ALTER TABLE public.products DROP CONSTRAINT "Price_Positive";
CheckConstraintQuotedVsUnquotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE products (
      id int,
      price int CONSTRAINT "Price_Check" CHECK (price > 0)
    );
  desired: |
    CREATE TABLE products (
      id int,
      price int CONSTRAINT Price_Check CHECK (price > 0)
    );
  up: |
    ALTER TABLE public.products DROP CONSTRAINT "Price_Check";
    ALTER TABLE public.products ADD CONSTRAINT price_check CHECK (price > 0);

  down: |
    ALTER TABLE public.products DROP CONSTRAINT price_check;
    ALTER TABLE public.products ADD CONSTRAINT "Price_Check" CHECK (price > 0);
UniqueConstraintQuotedColumns:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users ("Email" text, "Username" text);
  desired: |
    CREATE TABLE users (
      "Email" text,
      "Username" text,
      CONSTRAINT "unique_email" UNIQUE ("Email")
    );
  up: |
    ALTER TABLE public.users ADD CONSTRAINT "unique_email" UNIQUE ("Email");

  down: |
    ALTER TABLE public.users DROP CONSTRAINT "unique_email";
DropTableQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int);
  desired: ""
  up: |
    DROP TABLE public."Users";

  down: |
    CREATE TABLE "Users" (id int);
DropTableQuotedVsUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int);
    CREATE TABLE users (id int);
  desired: |
    CREATE TABLE users (id int);
  up: |
    DROP TABLE public."Users";

  down: |
    CREATE TABLE "Users" (id int);
DropIndexQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, email text);
    CREATE INDEX "EmailIndex" ON users (email);
  desired: |
    CREATE TABLE users (id int, email text);
  up: |
    DROP INDEX public."EmailIndex";

  down: |
    CREATE INDEX "EmailIndex" ON public.users (email);
DropIndexQuotedVsUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, email text, name text);
    CREATE INDEX "NameIndex" ON users (name);
    CREATE INDEX emailindex ON users (email);
  desired: |
    CREATE TABLE users (id int, email text, name text);
    CREATE INDEX emailindex ON users (email);
  up: |
    DROP INDEX public."NameIndex";

  down: |
    CREATE INDEX "NameIndex" ON public.users (name);
DropViewQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int);
    CREATE VIEW "ActiveUsers" AS SELECT id FROM users;
  desired: |
    CREATE TABLE users (id int);
  up: |
    DROP VIEW public."ActiveUsers";

  down: |
    CREATE VIEW "ActiveUsers" AS SELECT id FROM users;
DropViewQuotedVsUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int);
    CREATE VIEW "ActiveUsers" AS SELECT id FROM users;
    CREATE VIEW activeusers AS SELECT id FROM users;
  desired: |
    CREATE TABLE users (id int);
    CREATE VIEW activeusers AS SELECT id FROM users;
  up: |
    DROP VIEW public."ActiveUsers";

  down: |
    CREATE VIEW "ActiveUsers" AS SELECT id FROM users;
DropForeignKeyQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT "FK_Orders_Users" FOREIGN KEY (user_id) REFERENCES users (id)
    );
  desired: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (id int PRIMARY KEY, user_id int);
  up: |
    ALTER TABLE public.orders DROP CONSTRAINT "FK_Orders_Users";

  down: |
    ALTER TABLE public.orders ADD CONSTRAINT "FK_Orders_Users" FOREIGN KEY (user_id) REFERENCES public.users (id);
DropUniqueConstraintQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      email text,
      CONSTRAINT "Unique_Email" UNIQUE (email)
    );
  desired: |
    CREATE TABLE users (id int, email text);
  up: |
    ALTER TABLE public.users DROP CONSTRAINT "Unique_Email";

  down: |
    ALTER TABLE public.users ADD CONSTRAINT "Unique_Email" UNIQUE (email);
DropCheckConstraintQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE products (
      id int,
      price int,
      CONSTRAINT "Price_Positive" CHECK (price > 0)
    );
  desired: |
    CREATE TABLE products (id int, price int);
  up: |
    ALTER TABLE public.products DROP CONSTRAINT "Price_Positive";

  down: |
    ALTER TABLE public.products ADD CONSTRAINT "Price_Positive" CHECK (price > 0);
QuotedReservedWordAsTableName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "select" (id int);
  desired: |
    CREATE TABLE "select" (id int, "from" text);
  up: |
    ALTER TABLE public."select" ADD COLUMN "from" text;

  down: |
    ALTER TABLE public."select" DROP COLUMN "from";
DropQuotedReservedWordTable:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "table" (id int);
  desired: ""
  up: |
    DROP TABLE public."table";

  down: |
    CREATE TABLE "table" (id int);
QuotedReservedWordTableAddColumn:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "order" (id int);
  desired: |
    CREATE TABLE "order" (id int, "group" text NOT NULL);
  up: |
    ALTER TABLE public."order" ADD COLUMN "group" text NOT NULL;

  down: |
    ALTER TABLE public."order" DROP COLUMN "group";
QuotedReservedWordTableDropColumn:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "order" (id int, "group" text NOT NULL);
  desired: |
    CREATE TABLE "order" (id int);
  up: |
    ALTER TABLE public."order" DROP COLUMN "group";

  down: |
    ALTER TABLE public."order" ADD COLUMN "group" text NOT NULL;
QuotedIdentifierWithSpace:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "User Profiles" (id int);
  desired: |
    CREATE TABLE "User Profiles" (id int, "Full Name" text);
  up: |
    ALTER TABLE public."User Profiles" ADD COLUMN "Full Name" text;

  down: |
    ALTER TABLE public."User Profiles" DROP COLUMN "Full Name";
ModifyUniqueConstraintQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      email text,
      name text,
      CONSTRAINT "Unique_Email" UNIQUE (email)
    );
  desired: |
    CREATE TABLE users (
      id int,
      email text,
      name text,
      CONSTRAINT "Unique_Email" UNIQUE (email, name)
    );
  up: |
    ALTER TABLE public.users DROP CONSTRAINT "Unique_Email";
    ALTER TABLE public.users ADD CONSTRAINT "Unique_Email" UNIQUE (email, name);

  down: |
    ALTER TABLE public.users DROP CONSTRAINT "Unique_Email";
    ALTER TABLE public.users ADD CONSTRAINT "Unique_Email" UNIQUE (email);
RenameUniqueConstraintQuotedToUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      email text,
      CONSTRAINT "Email_Unique" UNIQUE (email)
    );
  desired: |
    CREATE TABLE users (
      id int,
      email text,
      CONSTRAINT email_unique UNIQUE (email)
    );
  up: |
    ALTER TABLE public.users ADD CONSTRAINT email_unique UNIQUE (email);
    ALTER TABLE public.users DROP CONSTRAINT "Email_Unique";

  down: |
    ALTER TABLE public.users ADD CONSTRAINT "Email_Unique" UNIQUE (email);
    ALTER TABLE public.users DROP CONSTRAINT "email_unique";
ForeignKeyMixedQuotedReferences:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Categories" ("CategoryId" int PRIMARY KEY);
    CREATE TABLE categories (id int PRIMARY KEY);
    CREATE TABLE products (
      id int PRIMARY KEY,
      quoted_cat_id int,
      unquoted_cat_id int
    );
  desired: |
    CREATE TABLE "Categories" ("CategoryId" int PRIMARY KEY);
    CREATE TABLE categories (id int PRIMARY KEY);
    CREATE TABLE products (
      id int PRIMARY KEY,
      quoted_cat_id int,
      unquoted_cat_id int,
      CONSTRAINT "fk_QuotedCat" FOREIGN KEY (quoted_cat_id) REFERENCES "Categories" ("CategoryId"),
      CONSTRAINT fk_unquoted_cat FOREIGN KEY (unquoted_cat_id) REFERENCES categories (id)
    );
  up: |
    ALTER TABLE public.products ADD CONSTRAINT "fk_QuotedCat" FOREIGN KEY (quoted_cat_id) REFERENCES public."Categories" ("CategoryId");
    ALTER TABLE public.products ADD CONSTRAINT fk_unquoted_cat FOREIGN KEY (unquoted_cat_id) REFERENCES public.categories (id);

  down: |
    ALTER TABLE public.products DROP CONSTRAINT "fk_QuotedCat";
    ALTER TABLE public.products DROP CONSTRAINT "fk_unquoted_cat";
DropForeignKeyKeepQuotedTable:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" ("UserId" int PRIMARY KEY);
    CREATE TABLE "Orders" (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT "FK_Order_User" FOREIGN KEY (user_id) REFERENCES "Users" ("UserId")
    );
  desired: |
    CREATE TABLE "Users" ("UserId" int PRIMARY KEY);
    CREATE TABLE "Orders" (id int PRIMARY KEY, user_id int);
  up: |
    ALTER TABLE public."Orders" DROP CONSTRAINT "FK_Order_User";

  down: |
    ALTER TABLE public."Orders" ADD CONSTRAINT "FK_Order_User" FOREIGN KEY (user_id) REFERENCES public."Users" ("UserId");
AddPrimaryKeyQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" ("UserId" int);
  desired: |
    CREATE TABLE "Users" ("UserId" int PRIMARY KEY);
  up: |
    ALTER TABLE public."Users" ADD PRIMARY KEY ("UserId");

  down: |
    ALTER TABLE public."Users" DROP CONSTRAINT "Users_pkey";
  # BUG: Down migration should also include: ALTER COLUMN "UserId" DROP NOT NULL
DropPrimaryKeyQuotedName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int PRIMARY KEY);
  desired: |
    CREATE TABLE users (id int NOT NULL);
  up: |
    ALTER TABLE public.users DROP CONSTRAINT users_pkey;

  down: |
    ALTER TABLE public.users ALTER COLUMN id DROP NOT NULL;
    ALTER TABLE public.users ADD PRIMARY KEY (id);
RenameQuotedColumnToUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "UserName" text
    );
  desired: |
    CREATE TABLE users (
      id int,
      username text -- @renamed from="UserName"
    );
  up: |
    ALTER TABLE public.users RENAME COLUMN "UserName" TO username;

  down: |
    ALTER TABLE public.users ADD COLUMN "UserName" text;
    ALTER TABLE public.users DROP COLUMN username;
RenameUnquotedColumnToQuoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      username text
    );
  desired: |
    CREATE TABLE users (
      id int,
      "UserName" text -- @renamed from=username
    );
  up: |
    ALTER TABLE public.users RENAME COLUMN username TO "UserName";

  down: |
    ALTER TABLE public.users ADD COLUMN username text;
    ALTER TABLE public.users DROP COLUMN "UserName";
RenameQuotedColumnToQuoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "OldName" text
    );
  desired: |
    CREATE TABLE users (
      id int,
      "NewName" text -- @renamed from="OldName"
    );
  up: |
    ALTER TABLE public.users RENAME COLUMN "OldName" TO "NewName";

  down: |
    ALTER TABLE public.users ADD COLUMN "OldName" text;
    ALTER TABLE public.users DROP COLUMN "NewName";
RenameQuotedColumnWithTypeChange:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "UserName" varchar(50)
    );
  desired: |
    CREATE TABLE users (
      id int,
      username text NOT NULL -- @renamed from="UserName"
    );
  up: |
    ALTER TABLE public.users RENAME COLUMN "UserName" TO username;
    ALTER TABLE public.users ALTER COLUMN username TYPE text;
    ALTER TABLE public.users ALTER COLUMN username SET NOT NULL;

  down: |
    ALTER TABLE public.users ADD COLUMN "UserName" varchar(50);
    ALTER TABLE public.users DROP COLUMN username;
RenameQuotedTableToUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "UserAccounts" (
      id int,
      name text
    );
  desired: |
    CREATE TABLE user_accounts ( -- @renamed from="UserAccounts"
      id int,
      name text
    );
  up: |
    ALTER TABLE public."UserAccounts" RENAME TO user_accounts;

  down: |
    CREATE TABLE "UserAccounts" (
      id int,
      name text
    );
    DROP TABLE public.user_accounts;
RenameUnquotedTableToQuoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE user_accounts (
      id int,
      name text
    );
  desired: |
    CREATE TABLE "UserAccounts" ( -- @renamed from=user_accounts
      id int,
      name text
    );
  up: |
    ALTER TABLE public.user_accounts RENAME TO "UserAccounts";

  down: |
    CREATE TABLE user_accounts (
      id int,
      name text
    );
    DROP TABLE public."UserAccounts";
RenameQuotedIndexToUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      email text
    );
    CREATE INDEX "EmailIndex" ON users (email);
  desired: |
    CREATE TABLE users (
      id int,
      email text
    );
    CREATE INDEX email_idx /* @renamed from="EmailIndex" */ ON users (email);
  up: |
    ALTER INDEX public."EmailIndex" RENAME TO email_idx;

  down: |
    CREATE INDEX "EmailIndex" ON public.users (email);
    DROP INDEX public.email_idx;
RenameUnquotedIndexToQuoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      email text
    );
    CREATE INDEX email_idx ON users (email);
  desired: |
    CREATE TABLE users (
      id int,
      email text
    );
    CREATE INDEX "EmailIndex" /* @renamed from=email_idx */ ON users (email);
  up: |
    ALTER INDEX public.email_idx RENAME TO "EmailIndex";

  down: |
    CREATE INDEX email_idx ON public.users (email);
    DROP INDEX public."EmailIndex";
QuotedSchemaName:
  legacy_ignore_quotes: false
  current: |
    CREATE SCHEMA "MySchema";
    CREATE TABLE "MySchema"."Users" (id int);
  desired: |
    CREATE SCHEMA "MySchema";
    CREATE TABLE "MySchema"."Users" (id int, name text);
  up: |
    ALTER TABLE "MySchema"."Users" ADD COLUMN name text;

  down: |
    ALTER TABLE "MySchema"."Users" DROP COLUMN name;
QuotedSchemaWithUnquotedTable:
  legacy_ignore_quotes: false
  current: |
    CREATE SCHEMA "MySchema";
    CREATE TABLE "MySchema".users (id int);
  desired: |
    CREATE SCHEMA "MySchema";
    CREATE TABLE "MySchema".users (id int, name text);
  up: |
    ALTER TABLE "MySchema".users ADD COLUMN name text;

  down: |
    ALTER TABLE "MySchema".users DROP COLUMN name;
CheckConstraintMixedQuotedColumns:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE orders (
      id int,
      min_price int,
      max_price int
    );
  desired: |
    CREATE TABLE orders (
      id int,
      min_price int,
      max_price int,
      CONSTRAINT "Price_Range" CHECK (min_price < max_price)
    );
  up: |
    ALTER TABLE public.orders ADD CONSTRAINT "Price_Range" CHECK (min_price < max_price);

  down: |
    ALTER TABLE public.orders DROP CONSTRAINT "Price_Range";
CheckConstraintQuotedConstraintName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE products (
      id int,
      price int
    );
  desired: |
    CREATE TABLE products (
      id int,
      price int CONSTRAINT "Positive_Price" CHECK (price > 0)
    );
  up: |
    ALTER TABLE public.products ADD CONSTRAINT "Positive_Price" CHECK (price > 0);

  down: |
    ALTER TABLE public.products DROP CONSTRAINT "Positive_Price";
RenameQuotedLowercaseToUnquotedNoOp:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "username" text
    );
  desired: |
    CREATE TABLE users (
      id int,
      username text
    );
  up: ""
  down: ""

RenameQuotedMixedCaseToUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "UserName" text
    );
  desired: |
    CREATE TABLE users (
      id int,
      username text -- @renamed from="UserName"
    );
  up: |
    ALTER TABLE public.users RENAME COLUMN "UserName" TO username;

  down: |
    ALTER TABLE public.users ADD COLUMN "UserName" text;
    ALTER TABLE public.users DROP COLUMN username;
TableQuotedLowercaseEqualsUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "users" (id int);
  desired: |
    CREATE TABLE users (id int, name text);
  up: |
    ALTER TABLE public.users ADD COLUMN name text;

  down: |
    ALTER TABLE public."users" DROP COLUMN name;
IndexQuotedLowercaseEqualsUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, email text);
    CREATE INDEX "email_idx" ON users (email);
  desired: |
    CREATE TABLE users (id int, email text);
    CREATE INDEX email_idx ON users (email);
  up: ""
  down: ""

ConstraintQuotedLowercaseEqualsUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      email text,
      CONSTRAINT "users_email_key" UNIQUE (email)
    );
  desired: |
    CREATE TABLE users (
      id int,
      email text,
      CONSTRAINT users_email_key UNIQUE (email)
    );
  up: ""
  down: ""

CreateUnquotedWhenQuotedMixedCaseExists:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int);
  desired: |
    CREATE TABLE "Users" (id int);
    CREATE TABLE users (id int);
  up: |
    CREATE TABLE users (id int);

  down: |
    DROP TABLE public.users;
ForeignKeyAutoNameWithQuotedColumn:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE categories (id int PRIMARY KEY);
    CREATE TABLE products (
      id int PRIMARY KEY,
      "CategoryId" int
    );
  desired: |
    CREATE TABLE categories (id int PRIMARY KEY);
    CREATE TABLE products (
      id int PRIMARY KEY,
      "CategoryId" int REFERENCES categories (id)
    );
  up: |
    ALTER TABLE public.products ADD CONSTRAINT "products_CategoryId_fkey" FOREIGN KEY ("CategoryId") REFERENCES public.categories (id);

  down: |
    ALTER TABLE public.products DROP CONSTRAINT "products_CategoryId_fkey";
CheckConstraintQuotedMixedCaseName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE products (id int, price int);
  desired: |
    CREATE TABLE products (
      id int,
      price int CONSTRAINT "PriceMustBePositive" CHECK (price > 0)
    );
  up: |
    ALTER TABLE public.products ADD CONSTRAINT "PriceMustBePositive" CHECK (price > 0);

  down: |
    ALTER TABLE public.products DROP CONSTRAINT "PriceMustBePositive";
DropCheckConstraintQuotedMixedCaseName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE products (
      id int,
      price int CONSTRAINT "PriceMustBePositive" CHECK (price > 0)
    );
  desired: |
    CREATE TABLE products (id int, price int);
  up: |
    ALTER TABLE public.products DROP CONSTRAINT "PriceMustBePositive";

  down: |
    ALTER TABLE public.products ADD CONSTRAINT "PriceMustBePositive" CHECK (price > 0);
MultipleColumnsQuotedVsUnquotedSameName:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "Name" text,
      name text
    );
  desired: |
    CREATE TABLE users (
      id int,
      "Name" text NOT NULL,
      name text NOT NULL
    );
  up: |
    ALTER TABLE public.users ALTER COLUMN "Name" SET NOT NULL;
    ALTER TABLE public.users ALTER COLUMN name SET NOT NULL;

  down: |
    ALTER TABLE public.users ALTER COLUMN "Name" DROP NOT NULL;
    ALTER TABLE public.users ALTER COLUMN name DROP NOT NULL;
DropQuotedColumnKeepUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "Name" text,
      name text
    );
  desired: |
    CREATE TABLE users (
      id int,
      name text
    );
  up: |
    ALTER TABLE public.users DROP COLUMN "Name";

  down: |
    ALTER TABLE public.users ADD COLUMN "Name" text;
UniqueConstraintOnQuotedColumn:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "Email" text
    );
  desired: |
    CREATE TABLE users (
      id int,
      "Email" text,
      CONSTRAINT "users_Email_key" UNIQUE ("Email")
    );
  up: |
    ALTER TABLE public.users ADD CONSTRAINT "users_Email_key" UNIQUE ("Email");

  down: |
    ALTER TABLE public.users DROP CONSTRAINT "users_Email_key";
PrimaryKeyOnQuotedColumn:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users ("UserId" int);
  desired: |
    CREATE TABLE users ("UserId" int PRIMARY KEY);
  up: |
    ALTER TABLE public.users ADD PRIMARY KEY ("UserId");

  down: |
    ALTER TABLE public.users DROP CONSTRAINT users_pkey;
  # BUG: Down migration should also include: ALTER COLUMN "UserId" DROP NOT NULL
IndexOnMixedQuotedColumns:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (
      id int,
      "FirstName" text,
      last_name text
    );
  desired: |
    CREATE TABLE users (
      id int,
      "FirstName" text,
      last_name text
    );
    CREATE INDEX name_idx ON users ("FirstName", last_name);
  up: |
    CREATE INDEX name_idx ON public.users ("FirstName", last_name);

  down: |
    DROP INDEX public.name_idx;
QuotedSchemaVsUnquotedSchemaDifferent:
  legacy_ignore_quotes: false
  current: |
    CREATE SCHEMA "MySchema";
    CREATE TABLE "MySchema".test (id int);
  desired: |
    CREATE SCHEMA "MySchema";
    CREATE TABLE "MySchema".test (id int);
    CREATE SCHEMA myschema;
    CREATE TABLE myschema.test (name text);
  up: |
    CREATE SCHEMA myschema;
    CREATE TABLE myschema.test (name text);

  down: |
    DROP TABLE myschema.test;
QuotedSchemaVsUnquotedSchemaModifyBoth:
  legacy_ignore_quotes: false
  current: |
    CREATE SCHEMA "MySchema";
    CREATE TABLE "MySchema".users (id int);
    CREATE SCHEMA myschema;
    CREATE TABLE myschema.users (id int);
  desired: |
    CREATE SCHEMA "MySchema";
    CREATE TABLE "MySchema".users (id int, quoted_col text);
    CREATE SCHEMA myschema;
    CREATE TABLE myschema.users (id int, unquoted_col text);
  up: |
    ALTER TABLE "MySchema".users ADD COLUMN quoted_col text;
    ALTER TABLE myschema.users ADD COLUMN unquoted_col text;

  down: |
    ALTER TABLE myschema.users DROP COLUMN unquoted_col;
    ALTER TABLE "MySchema".users DROP COLUMN quoted_col;
ForeignKeyUnquotedColumnsNotQuoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (id int PRIMARY KEY, user_id int);
  desired: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES users (id)
    );
  up: |
    ALTER TABLE public.orders ADD CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES public.users (id);

  down: |
    ALTER TABLE public.orders DROP CONSTRAINT "fk_user";
ForeignKeyMixedQuotedColumns:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE parent (
      "ParentId" int PRIMARY KEY
    );
    CREATE TABLE child (
      id int PRIMARY KEY,
      "ParentId" int,
      parent_code text
    );
  desired: |
    CREATE TABLE parent (
      "ParentId" int PRIMARY KEY
    );
    CREATE TABLE child (
      id int PRIMARY KEY,
      "ParentId" int,
      parent_code text,
      CONSTRAINT fk_parent FOREIGN KEY ("ParentId") REFERENCES parent ("ParentId")
    );
  up: |
    ALTER TABLE public.child ADD CONSTRAINT fk_parent FOREIGN KEY ("ParentId") REFERENCES public.parent ("ParentId");

  down: |
    ALTER TABLE public.child DROP CONSTRAINT "fk_parent";
ForeignKeyQuotedColumnToUnquotedColumn:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE categories (category_id int PRIMARY KEY);
    CREATE TABLE products (
      id int PRIMARY KEY,
      "CategoryId" int
    );
  desired: |
    CREATE TABLE categories (category_id int PRIMARY KEY);
    CREATE TABLE products (
      id int PRIMARY KEY,
      "CategoryId" int,
      CONSTRAINT fk_category FOREIGN KEY ("CategoryId") REFERENCES categories (category_id)
    );
  up: |
    ALTER TABLE public.products ADD CONSTRAINT fk_category FOREIGN KEY ("CategoryId") REFERENCES public.categories (category_id);

  down: |
    ALTER TABLE public.products DROP CONSTRAINT "fk_category";
ForeignKeyConstraintQuotedLowercaseEqualsUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT "fk_user" FOREIGN KEY (user_id) REFERENCES users (id)
    );
  desired: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES users (id)
    );
  up: ""
  down: ""

ForeignKeyConstraintQuotedMixedCaseDiffersFromUnquoted:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT "FK_User" FOREIGN KEY (user_id) REFERENCES users (id)
    );
  desired: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES users (id)
    );
  up: |
    ALTER TABLE public.orders ADD CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES public.users (id);
    ALTER TABLE public.orders DROP CONSTRAINT "FK_User";

  down: |
    ALTER TABLE public.orders ADD CONSTRAINT "FK_User" FOREIGN KEY (user_id) REFERENCES public.users (id);
    ALTER TABLE public.orders DROP CONSTRAINT "fk_user";
ForeignKeyRenameQuotedConstraint:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT "FK_Old_Name" FOREIGN KEY (user_id) REFERENCES users (id)
    );
  desired: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT "FK_New_Name" FOREIGN KEY (user_id) REFERENCES users (id)
    );
  up: |
    ALTER TABLE public.orders ADD CONSTRAINT "FK_New_Name" FOREIGN KEY (user_id) REFERENCES public.users (id);
    ALTER TABLE public.orders DROP CONSTRAINT "FK_Old_Name";

  down: |
    ALTER TABLE public.orders ADD CONSTRAINT "FK_Old_Name" FOREIGN KEY (user_id) REFERENCES public.users (id);
    ALTER TABLE public.orders DROP CONSTRAINT "FK_New_Name";
CheckConstraintUnquotedIdempotent:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE products (
      id int PRIMARY KEY,
      category_id int CHECK (category_id > 0)
    );
  desired: |
    CREATE TABLE products (
      id int PRIMARY KEY,
      category_id int CHECK (category_id > 0)
    );
  up: ""
  down: ""

UniqueConstraintUnquotedIdempotent:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE products (
      id int PRIMARY KEY,
      product_code text UNIQUE
    );
  desired: |
    CREATE TABLE products (
      id int PRIMARY KEY,
      product_code text UNIQUE
    );
  up: ""
  down: ""

CheckConstraintQuotedIdempotent:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Products" (
      id int PRIMARY KEY,
      "CategoryId" int CHECK ("CategoryId" > 0)
    );
  desired: |
    CREATE TABLE "Products" (
      id int PRIMARY KEY,
      "CategoryId" int CHECK ("CategoryId" > 0)
    );
  up: ""
  down: ""

UniqueConstraintQuotedIdempotent:
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Products" (
      id int PRIMARY KEY,
      "ProductCode" text UNIQUE
    );
  desired: |
    CREATE TABLE "Products" (
      id int PRIMARY KEY,
      "ProductCode" text UNIQUE
    );
  up: ""
  down: ""

ForeignKeyDependencyOrderingQuotedParent:
  legacy_ignore_quotes: false
  desired: |
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES "Users" (id)
    );
    CREATE TABLE "Users" (id int PRIMARY KEY);
  up: |
    CREATE TABLE "Users" (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES "Users" (id)
    );

  down: |
    DROP TABLE public.orders;
    DROP TABLE public."Users";
ForeignKeyDependencyOrderingQuotedLowercaseRef:
  legacy_ignore_quotes: false
  desired: |
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES "users" (id)
    );
    CREATE TABLE users (id int PRIMARY KEY);
  up: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES "users" (id)
    );

  down: |
    DROP TABLE public.orders;
    DROP TABLE public.users;
ForeignKeyDependencyOrderingUnquotedCaseMismatch:
  legacy_ignore_quotes: false
  desired: |
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES Users (id)
    );
    CREATE TABLE users (id int PRIMARY KEY);
  up: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE TABLE orders (
      id int PRIMARY KEY,
      user_id int,
      CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES Users (id)
    );

  down: |
    DROP TABLE public.orders;
    DROP TABLE public.users;
ViewDependencyOrderingUnquotedCaseMismatch:
  legacy_ignore_quotes: false
  desired: |
    CREATE VIEW user_summary AS SELECT id FROM Users;
    CREATE TABLE users (id int PRIMARY KEY);
  up: |
    CREATE TABLE users (id int PRIMARY KEY);
    CREATE VIEW user_summary AS SELECT id FROM Users;

  down: |
    DROP TABLE public.users;
    DROP VIEW public.user_summary;
AutoGeneratedConstraintFromQuotedTableAndColumn:
  # Verifies NewIdentWithQuoteDetected correctly infers quoting from case:
  # auto-generated name "Users_OrderId_check" has uppercase from both
  # quoted table "Users" and quoted column "OrderId".
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (
      id int,
      "OrderId" int
    );
  desired: |
    CREATE TABLE "Users" (
      id int,
      "OrderId" int CHECK ("OrderId" > 0)
    );
  up: |
    ALTER TABLE public."Users" ADD CONSTRAINT "Users_OrderId_check" CHECK ("OrderId" > 0);

  down: |
    ALTER TABLE public."Users" DROP CONSTRAINT "Users_OrderId_check";
FunctionalIndexOnQuotedColumn:
  # Functional index with quoted column should preserve quoting in expression
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, "UserName" text);
  desired: |
    CREATE TABLE users (id int, "UserName" text);
    CREATE INDEX username_lower_idx ON users (LOWER("UserName"));
  up: |
    CREATE INDEX username_lower_idx ON public.users (lower("UserName"));

  down: |
    DROP INDEX public.username_lower_idx;
FunctionalIndexOnUnquotedColumn:
  # Functional index with unquoted column should normalize to lowercase
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, username text);
  desired: |
    CREATE TABLE users (id int, username text);
    CREATE INDEX username_lower_idx ON users (LOWER(username));
  up: |
    CREATE INDEX username_lower_idx ON public.users (lower(username));

  down: |
    DROP INDEX public.username_lower_idx;
FunctionalIndexOnQuotedTable:
  # Functional index on quoted table with quoted column
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int, "Email" text);
  desired: |
    CREATE TABLE "Users" (id int, "Email" text);
    CREATE INDEX email_lower_idx ON "Users" (LOWER("Email"));
  up: |
    CREATE INDEX email_lower_idx ON public."Users" (lower("Email"));

  down: |
    DROP INDEX public.email_lower_idx;
CheckConstraintWithFunctionOnQuotedColumn:
  # CHECK constraint with function call on quoted column
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, "UserName" text);
  desired: |
    CREATE TABLE users (id int, "UserName" text CHECK (LENGTH("UserName") > 0));
  up: |
    ALTER TABLE public.users ADD CONSTRAINT "users_UserName_check" CHECK (length("UserName") > 0);

  down: |
    ALTER TABLE public.users DROP CONSTRAINT "users_UserName_check";
CheckConstraintWithFunctionOnUnquotedColumn:
  # CHECK constraint with function call on unquoted column
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, username text);
  desired: |
    CREATE TABLE users (id int, username text CHECK (LENGTH(username) > 0));
  up: |
    ALTER TABLE public.users ADD CONSTRAINT users_username_check CHECK (length(username) > 0);

  down: |
    ALTER TABLE public.users DROP CONSTRAINT users_username_check;
CheckConstraintWithNestedFunctionsQuotedColumn:
  # CHECK constraint with nested function calls on quoted column
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, "Email" text);
  desired: |
    CREATE TABLE users (id int, "Email" text CHECK (LENGTH(UPPER("Email")) > 0));
  up: |
    ALTER TABLE public.users ADD CONSTRAINT "users_Email_check" CHECK (length(upper("Email")) > 0);

  down: |
    ALTER TABLE public.users DROP CONSTRAINT "users_Email_check";
CheckConstraintWithMixedQuotedColumns:
  # CHECK constraint comparing quoted and unquoted columns
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, "StartDate" date, end_date date);
  desired: |
    CREATE TABLE users (
      id int,
      "StartDate" date,
      end_date date,
      CONSTRAINT date_order CHECK ("StartDate" < end_date)
    );
  up: |
    ALTER TABLE public.users ADD CONSTRAINT date_order CHECK ("StartDate" < end_date);

  down: |
    ALTER TABLE public.users DROP CONSTRAINT date_order;
CommentOnQuotedTable:
  # COMMENT on a quoted table should preserve the quoted name
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "UserAccounts" (id int);
  desired: |
    CREATE TABLE "UserAccounts" (id int);
    COMMENT ON TABLE "UserAccounts" IS 'User accounts table';
  up: |
    COMMENT ON TABLE public."UserAccounts" IS 'User accounts table';

  down: |
    COMMENT ON TABLE public."UserAccounts" IS NULL;
CommentOnUnquotedTable:
  # COMMENT on an unquoted table should normalize to lowercase
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE UserAccounts (id int);
  desired: |
    CREATE TABLE UserAccounts (id int);
    COMMENT ON TABLE UserAccounts IS 'User accounts table';
  up: |
    COMMENT ON TABLE public.useraccounts IS 'User accounts table';

  down: |
    COMMENT ON TABLE public."useraccounts" IS NULL;
CommentOnQuotedColumn:
  # COMMENT on a quoted column should preserve the quoted name
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, "UserName" text);
  desired: |
    CREATE TABLE users (id int, "UserName" text);
    COMMENT ON COLUMN users."UserName" IS 'User display name';
  up: |
    COMMENT ON COLUMN public.users."UserName" IS 'User display name';

  down: |
    COMMENT ON COLUMN public."users"."UserName" IS NULL;
CommentOnUnquotedColumn:
  # COMMENT on an unquoted column should normalize to lowercase
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, UserName text);
  desired: |
    CREATE TABLE users (id int, UserName text);
    COMMENT ON COLUMN users.UserName IS 'User display name';
  up: |
    COMMENT ON COLUMN public.users.username IS 'User display name';

  down: |
    COMMENT ON COLUMN public."users"."username" IS NULL;
CommentOnMixedQuotedTableAndColumn:
  # COMMENT on a quoted table with quoted column
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int, "Email" text);
  desired: |
    CREATE TABLE "Users" (id int, "Email" text);
    COMMENT ON TABLE "Users" IS 'Users table';
    COMMENT ON COLUMN "Users"."Email" IS 'User email address';
  up: |
    COMMENT ON TABLE public."Users" IS 'Users table';
    COMMENT ON COLUMN public."Users"."Email" IS 'User email address';

  down: |
    COMMENT ON TABLE public."Users" IS NULL;
    COMMENT ON COLUMN public."Users"."Email" IS NULL;
CommentUpdateOnQuotedTable:
  # Update an existing COMMENT on a quoted table
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "UserProfiles" (id int);
    COMMENT ON TABLE "UserProfiles" IS 'Old comment';
  desired: |
    CREATE TABLE "UserProfiles" (id int);
    COMMENT ON TABLE "UserProfiles" IS 'New comment';
  up: |
    COMMENT ON TABLE public."UserProfiles" IS 'New comment';

  down: |
    COMMENT ON TABLE public."UserProfiles" IS 'Old comment';
CommentRemoveOnQuotedTable:
  # Remove COMMENT from a quoted table
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "UserProfiles" (id int);
    COMMENT ON TABLE "UserProfiles" IS 'Table comment';
  desired: |
    CREATE TABLE "UserProfiles" (id int);
  up: |
    COMMENT ON TABLE public."UserProfiles" IS NULL;

  down: |
    COMMENT ON TABLE public."UserProfiles" IS 'Table comment';
CommentOnBothQuotedAndUnquotedTables:
  # When both quoted "Users" and unquoted users exist, comments should be distinct
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "Users" (id int);
    CREATE TABLE users (id int);
  desired: |
    CREATE TABLE "Users" (id int);
    CREATE TABLE users (id int);
    COMMENT ON TABLE "Users" IS 'Quoted Users table';
    COMMENT ON TABLE users IS 'Unquoted users table';
  up: |
    COMMENT ON TABLE public."Users" IS 'Quoted Users table';
    COMMENT ON TABLE public.users IS 'Unquoted users table';

  down: |
    COMMENT ON TABLE public."Users" IS NULL;
    COMMENT ON TABLE public."users" IS NULL;
CommentIdempotentQuotedTable:
  # COMMENT on quoted table should be idempotent (no change if already set)
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE "UserData" (id int);
    COMMENT ON TABLE "UserData" IS 'Same comment';
  desired: |
    CREATE TABLE "UserData" (id int);
    COMMENT ON TABLE "UserData" IS 'Same comment';
  up: ""
  down: ""

CommentIdempotentQuotedColumn:
  # COMMENT on quoted column should be idempotent (no change if already set)
  legacy_ignore_quotes: false
  current: |
    CREATE TABLE users (id int, "FullName" text);
    COMMENT ON COLUMN users."FullName" IS 'Full name of user';
  desired: |
    CREATE TABLE users (id int, "FullName" text);
    COMMENT ON COLUMN users."FullName" IS 'Full name of user';
  up: ""
  down: ""
