CreateTable:
  desired: |
    CREATE TABLE users (
      id integer NOT NULL,
      name text,
      age integer
    );
DropTable:
  current: |
    CREATE TABLE users (
      id integer NOT NULL,
      name text,
      age integer
    );
    CREATE TABLE bigdata (
      data integer
    );
  desired: |
    CREATE TABLE users (
      id integer NOT NULL,
      name text,
      age integer
    );
  output: |
    DROP TABLE `bigdata`;
CreateTableQuotes:
  current: |
    CREATE TABLE "test_table" (
      id integer primary key
    );
  desired: |
    CREATE TABLE `test_table` (
      id integer primary key
    );
  output: ''
CreateTableWithAutoincrement:
  desired: |
    CREATE TABLE users (
      id integer PRIMARY KEY AUTOINCREMENT,
      name text,
      age integer
    );
CreateView:
  current: |
    CREATE TABLE users (
      id integer NOT NULL,
      name text,
      age integer
    );
  desired: |
    CREATE TABLE users (
      id integer NOT NULL,
      name text,
      age integer
    );
    CREATE VIEW `view_users` AS select id from users where age = 1;
  output: |
    CREATE VIEW `view_users` AS select id from users where age = 1;
DropAndCreateView:
  current: |
    CREATE TABLE users (
      id integer NOT NULL,
      name text,
      age integer
    );
    CREATE VIEW `view_users` AS select id from users where age = 1;
  desired: |
    CREATE TABLE users (
      id integer NOT NULL,
      name text,
      age integer
    );
    CREATE VIEW `view_users` AS select id from users where age = 2;
  output: |
    DROP VIEW `view_users`;
    CREATE VIEW `view_users` AS select id from users where age = 2;
ColumnLiteral:
  desired: |
    CREATE TABLE users (
      id integer NOT NULL,
      name text,
      age integer
    );
DataTypes:
  # Remaining SQL spec: bit varying, interval, numeric, decimal, real,
  # smallint, smallserial, xml
  desired: |
    CREATE TABLE users (
      c_timestamp timestamp,
      c_integer integer,
      c_text text
    );
BlobType:
  desired: |
    CREATE TABLE bigdata (
      data
    );
SingleQuotedID:
  desired: |
    CREATE TABLE 'bigdata' (
      'data' integer
    );
Index:
  desired: |
    CREATE TABLE bigdata (
      -- unique constraint generates an index entry automatically in sqlite_master table
      path text UNIQUE,
      data integer
    );
    CREATE INDEX index_bigdata ON bigdata(data);
TableOptions:
  desired: |
    CREATE TABLE bigdata(
      id integer PRIMARY KEY,
      data text
    ) STRICT, WITHOUT ROWID;
ForeignKeyConstraint:
  desired: |
    CREATE TABLE artist(
      artistid    INTEGER PRIMARY KEY,
      artistname  TEXT
    );
    CREATE TABLE track(
      trackid     INTEGER,
      trackname   TEXT,
      trackartist INTEGER REFERENCES artist(artistid)
    );
IndependentConstraintDefinition:
  desired: |
    CREATE TABLE artist(
      artistid    INTEGER,
      artistname  TEXT,
      PRIMARY KEY(artistid)
    );
    CREATE TABLE track(
      trackid     INTEGER,
      trackname   TEXT,
      trackartist INTEGER,
      CHECK (trackid > 0),
      FOREIGN KEY(trackartist) REFERENCES artist(artistid)
    );

RenameColumn:
  current: |
    CREATE TABLE users (
      id bigint NOT NULL,
      username text,
      age integer
    );
  desired: |
    CREATE TABLE users (
      id bigint NOT NULL,
      user_name text, -- @rename from=username
      age integer
    );
  output: |
    ALTER TABLE `users` RENAME COLUMN `username` TO `user_name`;

RenameColumnWithTypeChange:
  current: |
    CREATE TABLE users (
      id bigint NOT NULL,
      username varchar(100),
      age integer
    );
  desired: |
    CREATE TABLE users (
      id bigint NOT NULL,
      user_name text NOT NULL, -- @rename from=username
      age integer
    );
  output: |
    ALTER TABLE `users` ADD COLUMN `user_name` text NOT NULL;
    UPDATE `users` SET `user_name` = `username`;
    ALTER TABLE `users` DROP COLUMN `username`;

RenameTable:
  current: |
    CREATE TABLE user_accounts (
      id bigint NOT NULL,
      username text,
      age integer
    );
  desired: |
    CREATE TABLE users ( -- @rename from=user_accounts
      id bigint NOT NULL,
      username text,
      age integer
    );
  output: |
    ALTER TABLE `user_accounts` RENAME TO `users`;

RenameTableWithCommentVariant:
  current: |
    CREATE TABLE old_users (
      id bigint NOT NULL,
      name text
    );
  desired: |
    CREATE TABLE new_users /* @rename from=old_users */ (
      id bigint NOT NULL,
      name text
    );
  output: |
    ALTER TABLE `old_users` RENAME TO `new_users`;

RenameTableWithQuotedName:
  current: |
    CREATE TABLE "user accounts" (
      id bigint NOT NULL,
      name text
    );
  desired: |
    CREATE TABLE "user_profiles" ( -- @rename from="user accounts"
      id bigint NOT NULL,
      name text
    );
  output: |
    ALTER TABLE `user accounts` RENAME TO `user_profiles`;

RenameTableAndMultipleColumnChanges:
  current: |
    CREATE TABLE old_accounts (
      id bigint NOT NULL,
      user_name varchar(50),
      is_active integer,
      old_field text
    );
  desired: |
    CREATE TABLE accounts ( -- @rename from=old_accounts
      id bigint NOT NULL,
      username varchar(100) NOT NULL, -- @rename from=user_name
      is_active integer DEFAULT 1,
      created_at timestamp DEFAULT CURRENT_TIMESTAMP
    );
  output: |
    ALTER TABLE `old_accounts` RENAME TO `accounts`;
    ALTER TABLE `accounts` ADD COLUMN `username` varchar(100) NOT NULL;
    UPDATE `accounts` SET `username` = `user_name`;
    ALTER TABLE `accounts` DROP COLUMN `user_name`;
    ALTER TABLE `accounts` ADD COLUMN `created_at` timestamp DEFAULT current_timestamp;
    ALTER TABLE `accounts` DROP COLUMN `old_field`;
